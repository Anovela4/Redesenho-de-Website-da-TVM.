git add README.md<!doctype html>
<html lang="pt-MZ">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TVM — Redesenho (Protótipo)</title>
  <meta name="description" content="Protótipo de redesenho do website da TVM com foco em usabilidade, acessibilidade e funcionalidades interativas." />
  <style>
    /* Reset + base */
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa5b1; --accent:#0066cc; --accent-2:#00bfa5; --glass: rgba(255,255,255,0.03);
      --radius:12px; --max-width:1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,#071022 0%, #081328 60%); color:#e6eef6; line-height:1.45; -webkit-font-smoothing:antialiased;
      padding:24px; display:flex; justify-content:center;
    }
    .shell{width:100%; max-width:var(--max-width)}

    /* Header */
    header{display:flex; align-items:center; gap:20px; margin-bottom:18px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:56px; height:56px; border-radius:10px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:flex; align-items:center; justify-content:center; font-weight:700; font-size:20px}
    h1{font-size:18px; margin:0}
    p.lead{margin:0; color:var(--muted); font-size:13px}

    /* Toolbar */
    .toolbar{display:flex; gap:12px; margin:14px 0 18px; align-items:center}
    .search-wrap{flex:1; display:flex; align-items:center; gap:8px}
    input[type=search]{flex:1; min-width:0; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit}
    select, button{padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.06); background:transparent; color:inherit}
    .primary{background:linear-gradient(90deg,var(--accent),var(--accent-2)); border:none; color:#021018}

    /* Layout */
    .content{display:grid; grid-template-columns: 320px 1fr; gap:18px}
    @media (max-width:900px){.content{grid-template-columns:1fr}}

    /* Sidebar */
    .sidebar{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:16px; border-radius:var(--radius)}
    .filters h3{margin:0 0 8px 0; font-size:14px}
    .chip{display:inline-block; padding:6px 10px; margin:6px 6px 0 0; border-radius:999px; background:rgba(255,255,255,0.03); color:var(--muted); cursor:pointer; border:1px solid rgba(255,255,255,0.02)}
    .chip[aria-pressed="true"]{background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021018}

    /* Main list */
    .main{min-height:400px}
    .card{display:flex; gap:16px; padding:14px; margin-bottom:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; align-items:center}
    .thumb{width:110px; height:70px; border-radius:8px; background:#072033; display:flex; align-items:center; justify-content:center; font-size:14px}
    .meta{flex:1}
    .title{font-weight:600; margin:0 0 6px 0}
    .desc{margin:0; color:var(--muted); font-size:13px}
    .meta small{color:var(--muted)}

    /* Controls inside card */
    .actions{display:flex; gap:8px}
    .icon-btn{border-radius:8px; padding:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; cursor:pointer}
    .danger{background:transparent; border:1px solid rgba(255,80,80,0.14); color:#ffb3b3}

    /* Empty state */
    .empty{padding:40px; text-align:center; color:var(--muted); background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:12px}

    /* Add form modal */
    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(2,6,12,0.6); z-index:50}
    .modal.open{display:flex}
    .modal-panel{width:100%; max-width:720px; padding:18px; background:#071022; border-radius:12px; box-shadow:0 10px 30px rgba(2,6,12,0.7)}
    .form-grid{display:grid; grid-template-columns:1fr 160px; gap:12px}
    .form-grid input, .form-grid select, textarea{width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit}

    /* footer */
    footer{margin-top:18px; color:var(--muted); font-size:13px}

    /* small screens adjustments */
    @media (max-width:500px){.form-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="shell" role="application" aria-labelledby="app-title">
    <header>
      <div class="brand" aria-hidden="false">
        <div class="logo" aria-hidden="true">TVM</div>
        <div>
          <h1 id="app-title">TVM — Redesenho</h1>
          <p class="lead">Protótipo centrado no utilizador: conteúdo, usabilidade e acessibilidade</p>
        </div>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px">
        <button class="primary" id="openAdd">Adicionar Conteúdo</button>
        <button id="resetStorage" title="Resetar dados de demonstração">Reset</button>
      </div>
    </header>

    <div class="toolbar" role="region" aria-label="Ferramentas de navegação">
      <div class="search-wrap">
        <label for="searchInput" class="sr-only">Pesquisar conteúdos</label>
        <input id="searchInput" type="search" placeholder="Pesquisar por título ou categoria..." aria-label="Pesquisar" />
        <select id="categoryFilter" aria-label="Filtrar por categoria">
          <option value="all">Todas as categorias</option>
        </select>
      </div>
      <select id="sortBy" aria-label="Ordenar por">
        <option value="date_desc">Data — mais recentes</option>
        <option value="date_asc">Data — mais antigos</option>
        <option value="title_asc">Título — A–Z</option>
        <option value="title_desc">Título — Z–A</option>
      </select>
      <button id="clearSearch" title="Limpar pesquisa">Limpar</button>
    </div>

    <main class="content">
      <aside class="sidebar" aria-label="Filtros e categorias">
        <section class="filters" aria-labelledby="catTitle">
          <h3 id="catTitle">Categorias</h3>
          <div id="chips" role="toolbar" aria-label="Categorias disponíveis"></div>
        </section>

        <section style="margin-top:12px">
          <h3>Ajuda rápida</h3>
          <p class="desc">Use a barra de pesquisa para encontrar programas, notícias ou serviços. Adicione conteúdo com o botão "Adicionar Conteúdo". As alterações ficam armazenadas localmente (localStorage).</p>
        </section>
      </aside>

      <section class="main" aria-live="polite">
        <div id="list"></div>
        <div id="emptyState" class="empty" hidden>
          <strong>Nenhum conteúdo encontrado</strong>
          <p>Tente ajustar os filtros ou adicione novos conteúdos.</p>
        </div>
      </section>
    </main>

    <footer>
      Protótipo — TVM Redesigned • Melhorias de usabilidade, acessibilidade e responsividade.
    </footer>
  </div>

  <!-- Modal: Add content -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-panel">
      <h2 id="modalTitle">Adicionar Novo Conteúdo</h2>
      <form id="addForm">
        <div class="form-grid">
          <div>
            <label for="title">Título</label>
            <input id="title" name="title" required maxlength="120" />

            <label for="category">Categoria</label>
            <input id="category" name="category" required maxlength="40" />

            <label for="date">Data</label>
            <input id="date" name="date" type="date" required />

            <label for="desc">Descrição</label>
            <textarea id="desc" name="desc" rows="4"></textarea>
          </div>

          <div>
            <label for="type">Tipo</label>
            <select id="type" name="type">
              <option value="notícia">Notícia</option>
              <option value="programa">Programa</option>
              <option value="vídeo">Vídeo</option>
              <option value="serviço">Serviço</option>
            </select>

            <label for="featured">Destaque</label>
            <select id="featured" name="featured">
              <option value="false">Não</option>
              <option value="true">Sim</option>
            </select>

            <div style="margin-top:12px; display:flex; gap:8px">
              <button class="primary" type="submit">Guardar</button>
              <button type="button" id="cancelAdd">Cancelar</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <script>
    /***********************
     * Dados iniciais (exemplo) — estrutura simples representando conteúdos TVM
     ***********************/
    const DEMO_KEY = 'tvm_demo_data_v1'
    const demoData = [
      {id: genId(), title:'Jornal Nacional - Edição da Noite', category:'Notícias', date:'2025-10-28', desc:'Resumo dos acontecimentos nacionais', type:'notícia', featured:true},
      {id: genId(), title:'Programa Cultural — Palco Aberto', category:'Programas', date:'2025-09-12', desc:'Música e cultura local', type:'programa', featured:false},
      {id: genId(), title:'Serviço: Guia de Emissão de Vistos', category:'Serviços', date:'2025-06-05', desc:'Informações práticas para cidadãos', type:'serviço', featured:false},
      {id: genId(), title:'Série Documental sobre Maputo', category:'Documentários', date:'2025-07-20', desc:'História e urbanismo de Maputo', type:'vídeo', featured:true},
      {id: genId(), title:'Tempo Hoje — Previsão', category:'Notícias', date:'2025-11-01', desc:'Previsão meteorológica atualizada', type:'notícia', featured:false}
    ]

    // ===== utilidades =====
    function genId(){return 'id-'+Math.random().toString(36).slice(2,9)}

    // Inicialização: carregar do localStorage ou usar demo
    function loadData(){
      try{
        const raw = localStorage.getItem(DEMO_KEY)
        return raw? JSON.parse(raw) : demoData.slice()
      }catch(e){return demoData.slice()}
    }
    function saveData(arr){ localStorage.setItem(DEMO_KEY, JSON.stringify(arr)) }

    // ===== state =====
    let items = loadData()
    let index = buildIndex(items) // índice para busca rápida
    let activeCategory = 'all'
    let lastSearch = ''

    // Build simple inverted index (lowercase) for title and category to speed up searches
    function buildIndex(list){
      const idx = {titles:[], cats:[]}
      list.forEach(it => { idx.titles.push({id:it.id, text: (it.title||'').toLowerCase()}); idx.cats.push({id:it.id, text:(it.category||'').toLowerCase()}) })
      return idx
    }

    // ===== rendering =====
    const listEl = document.getElementById('list')
    const emptyEl = document.getElementById('emptyState')
    const chipsEl = document.getElementById('chips')
    const catSelect = document.getElementById('categoryFilter')

    function render(){
      // fill categories
      const cats = Array.from(new Set(items.map(i=>i.category))).sort()
      chipsEl.innerHTML = ''
      catSelect.innerHTML = '<option value="all">Todas as categorias</option>'
      cats.forEach(c => {
        const btn = document.createElement('button')
        btn.className = 'chip'
        btn.type = 'button'
        btn.textContent = c
        btn.setAttribute('aria-pressed', activeCategory===c)
        btn.onclick = ()=>{ activeCategory = (activeCategory===c? 'all': c); applyFilters(); render() }
        chipsEl.appendChild(btn)

        const opt = document.createElement('option'); opt.value=c; opt.text = c; catSelect.appendChild(opt)
      })

      // produce list
      const filtered = queryItems(lastSearch, activeCategory)
      if(filtered.length===0){ listEl.innerHTML=''; emptyEl.hidden=false; return }
      emptyEl.hidden=true

      const frag = document.createDocumentFragment()
      filtered.forEach(it=>{
        const card = document.createElement('article')
        card.className='card'
        card.setAttribute('tabindex','0')
        card.innerHTML = `
          <div class="thumb" aria-hidden="true">${it.type[0].toUpperCase()}</div>
          <div class="meta">
            <h3 class="title">${escapeHtml(it.title)}</h3>
            <p class="desc">${escapeHtml(it.desc || '')}</p>
            <div style="margin-top:8px"><small>${escapeHtml(it.category)} • ${formatDate(it.date)}</small></div>
          </div>
          <div class="actions">
            <button class="icon-btn" data-id="${it.id}" data-action="view">Ver</button>
            <button class="icon-btn" data-id="${it.id}" data-action="edit">Editar</button>
            <button class="icon-btn danger" data-id="${it.id}" data-action="delete">Remover</button>
          </div>
        `
        frag.appendChild(card)
      })
      listEl.innerHTML=''
      listEl.appendChild(frag)

      // attach action listeners (event delegation would be better for large lists)
      listEl.querySelectorAll('button[data-action]').forEach(b=>{
        b.onclick = handleCardAction
      })
    }

    // ===== search & filter (com debounce) =====
    const searchInput = document.getElementById('searchInput')
    let searchTimer = null
    searchInput.addEventListener('input', e => {
      clearTimeout(searchTimer)
      const v = e.target.value.trim()
      searchTimer = setTimeout(()=>{ lastSearch = v; applyFilters() }, 250)
    })
    document.getElementById('clearSearch').addEventListener('click', ()=>{ searchInput.value=''; lastSearch=''; applyFilters(); searchInput.focus() })

    document.getElementById('sortBy').addEventListener('change', ()=>applyFilters())
    catSelect.addEventListener('change', (e)=>{ activeCategory = e.target.value; applyFilters(); render() })

    function applyFilters(){
      // search and category applied in queryItems(); then sort according to dropdown
      renderSorted()
    }

    function renderSorted(){
      const sortBy = document.getElementById('sortBy').value
      let result = queryItems(lastSearch, activeCategory)
      switch(sortBy){
        case 'date_asc': result.sort((a,b)=> new Date(a.date)-new Date(b.date)); break
        case 'date_desc': result.sort((a,b)=> new Date(b.date)-new Date(a.date)); break
        case 'title_asc': result.sort((a,b)=> a.title.localeCompare(b.title)); break
        case 'title_desc': result.sort((a,b)=> b.title.localeCompare(a.title)); break
      }
      // temporarily replace items rendered by render(); we'll render via same card logic
      listEl.innerHTML=''
      if(result.length===0){ emptyEl.hidden=false; return }
      emptyEl.hidden=true
      const frag = document.createDocumentFragment()
      result.forEach(it=>{
        const card = document.createElement('article')
        card.className='card'
        card.setAttribute('tabindex','0')
        card.innerHTML = `
          <div class="thumb" aria-hidden="true">${it.type[0].toUpperCase()}</div>
          <div class="meta">
            <h3 class="title">${escapeHtml(it.title)}</h3>
            <p class="desc">${escapeHtml(it.desc || '')}</p>
            <div style="margin-top:8px"><small>${escapeHtml(it.category)} • ${formatDate(it.date)}</small></div>
          </div>
          <div class="actions">
            <button class="icon-btn" data-id="${it.id}" data-action="view">Ver</button>
            <button class="icon-btn" data-id="${it.id}" data-action="edit">Editar</button>
            <button class="icon-btn danger" data-id="${it.id}" data-action="delete">Remover</button>
          </div>
        `
        frag.appendChild(card)
      })
      listEl.appendChild(frag)
      listEl.querySelectorAll('button[data-action]').forEach(b=>{ b.onclick = handleCardAction })
    }

    // Efficient query using prebuilt lowercase index
    function queryItems(search, category){
      let ids = new Set(items.map(i=>i.id))
      if(category && category!=='all'){
        items.filter(i=>i.category===category).forEach(i=>{} )
        ids = new Set(items.filter(i=> i.category===category).map(i=>i.id))
      }
      if(search && search.length>0){
        const q = search.toLowerCase()
        // search in titles and categories using index arrays to reduce repeated lowercasing
        const matched = new Set()
        index.titles.forEach(t=>{ if(t.text.includes(q)) matched.add(t.id) })
        index.cats.forEach(c=>{ if(c.text.includes(q)) matched.add(c.id) })
        // intersect
        ids = new Set([...ids].filter(id=> matched.has(id)))
      }
      return items.filter(i=> ids.has(i.id))
    }

    // ===== card actions (view, edit, delete) =====
    function handleCardAction(e){
      const id = e.currentTarget.dataset.id
      const action = e.currentTarget.dataset.action
      if(action==='delete'){
        if(confirm('Remover este conteúdo?')){ items = items.filter(x=>x.id!==id); saveData(items); index = buildIndex(items); render(); }
        return
      }
      if(action==='view'){
        const it = items.find(x=>x.id===id)
        alert(`${it.title}\n\nCategoria: ${it.category}\nData: ${it.date}\n\n${it.desc}`)
        return
      }
      if(action==='edit'){
        const it = items.find(x=>x.id===id)
        openModalFor(it)
        return
      }
    }

    // ===== modal and form handling =====
    const modal = document.getElementById('modal')
    const openAdd = document.getElementById('openAdd')
    const cancelAdd = document.getElementById('cancelAdd')
    const addForm = document.getElementById('addForm')

    openAdd.addEventListener('click', ()=> openModalFor(null))
    cancelAdd.addEventListener('click', ()=> closeModal())

    function openModalFor(item){
      modal.classList.add('open')
      if(item){
        document.getElementById('title').value = item.title
        document.getElementById('category').value = item.category
        document.getElementById('date').value = item.date
        document.getElementById('desc').value = item.desc || ''
        document.getElementById('type').value = item.type || 'notícia'
        document.getElementById('featured').value = item.featured? 'true':'false'
        addForm.dataset.edit = item.id
      }else{
        addForm.reset(); delete addForm.dataset.edit
        const today = new Date().toISOString().slice(0,10)
        document.getElementById('date').value = today
      }
      // focus on title
      setTimeout(()=>document.getElementById('title').focus(),100)
    }
    function closeModal(){ modal.classList.remove('open'); addForm.reset(); delete addForm.dataset.edit }

    addForm.addEventListener('submit', (e)=>{
      e.preventDefault()
      const data = {
        id: addForm.dataset.edit || genId(),
        title: document.getElementById('title').value.trim(),
        category: document.getElementById('category').value.trim() || 'Geral',
        date: document.getElementById('date').value,
        desc: document.getElementById('desc').value.trim(),
        type: document.getElementById('type').value,
        featured: document.getElementById('featured').value === 'true'
      }
      if(addForm.dataset.edit){
        // update
        items = items.map(it => it.id===data.id? Object.assign({}, it, data): it)
      } else {
        items.unshift(data)
      }
      saveData(items); index = buildIndex(items); closeModal(); render();
    })

    // reset demo
    document.getElementById('resetStorage').addEventListener('click', ()=>{ if(confirm('Restaurar dados de demonstração?')){ localStorage.removeItem(DEMO_KEY); items = loadData(); index = buildIndex(items); render() } })

    // helpful utils
    function formatDate(d){ if(!d) return ''; try{return new Date(d).toLocaleDateString('pt-MZ',{year:'numeric',month:'short',day:'numeric'})}catch(e){return d} }
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c] }) }

    // keyboard accessibility: close modal on esc
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.classList.contains('open')) closeModal() })

    // initial render
    render()

    /*************** notas sobre implementacao ***************
      - O protótipo é responsivo e acessível (atributos ARIA, foco, controles com teclado).
      - Busca eficiente: cria-se um índice lowercase (index.titles, index.cats) para evitar lowercasing repetido em grandes listas.
      - Ordenação e filtros aplicados no cliente; para datasets maiores, recomendam-se chamadas ao servidor com paginação.
      - Persistência local via localStorage para demonstração; substituir por API/DB em produção.
    *******************************************************/
  </script>
</body>
</html>
